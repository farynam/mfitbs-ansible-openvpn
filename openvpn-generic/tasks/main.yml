---
# tasks file for openvpn-generic
- name: install apt packages
  apt:
    name:
      - python
      - python-setuptools=40.8.0-1
      - python-dev=2.7.16-1
      - build-essential=12.6
      - python-pip=18.1-5
      - python-apt=1.8.4
      - sshpass=1.06-1
      - rsync=3.1.3-6

- name: Install python modules
  pip:
    name:
      - ansible==2.8.5
      - pexpect==4.7.0

- name: Install OPENVPN
  apt:
    name: openvpn=2.4.7-1

- name: Create host pki dir
  file:
    path: "{{host_pki_dir}}"
    state: directory
    mode: '0770'

- name: Generate diffie helman
  command: openssl dhparam -out {{host_pki_dir}}/{{dh}}.pem {{dh_len}}
  args:
    creates: "{{host_pki_dir}}/{{dh}}.pem"